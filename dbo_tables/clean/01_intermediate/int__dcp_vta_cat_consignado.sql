with de_duplicacion_vtacatconsignado  as ( 
select
		--{{ dbt_utils.generate_surrogate_key(['col_pk1', 'col_pk2']) }} as pk_vtacatconsignado,
		
		calle,
		taxid,
		cucsfid,
		eslocal,
		espuela,
		contacto,
		fechaalta,
		bajalogica,
		cuentacsid,
		cuentasfid,
		entrecalles,
		nombrepcmod,
		numexterior,
		numinterior,
		_ab_cdc_lsn,
		esautofleteo,
		notaembarque,
		claconsignado,
		clamotivobaja,
		clausuariomod,
		esnocargariva,
		claciudadunico,
		claferroviaria,
		comentariobaja,
		consignadosfid,
		fechaultimamod,
		_ab_cdc_cursor,
		claciudadlegacy,
		max(claclienteunico) as claclienteunico,
		clacodigopostal,
		clacoloniaunico,
		fechabajalogica,
		ladanotificante,
		clamedioembarque,
		essiemprevigente,
		nombreconsignado,
		mc_consignado_id,
		correonotificante,
		nombrenotificante,
		esdomicilioenlegal,
		_ab_cdc_deleted_at,
		_ab_cdc_updated_at,
		codigopostalimprime,
		telefononotificante,
		claestatusconsignado,
		esgeneracargoimpuesto,
		_ab_cdc_event_serial_no,
		claveinternacionalnotificante
		from {{ref('stg__vta_cat_consignado')}}
        GROUP by 
		calle,
		taxid,
		cucsfid,
		eslocal,
		espuela,
		contacto,
		fechaalta,
		bajalogica,
		cuentacsid,
		cuentasfid,
		entrecalles,
		nombrepcmod,
		numexterior,
		numinterior,
		_ab_cdc_lsn,
		esautofleteo,
		notaembarque,
		claconsignado,
		clamotivobaja,
		clausuariomod,
		esnocargariva,
		claciudadunico,
		claferroviaria,
		comentariobaja,
		consignadosfid,
		fechaultimamod,
		_ab_cdc_cursor,
		claciudadlegacy,
		clacodigopostal,
		clacoloniaunico,
		fechabajalogica,
		ladanotificante,
		clamedioembarque,
		essiemprevigente,
		nombreconsignado,
		mc_consignado_id,
		correonotificante,
		nombrenotificante,
		esdomicilioenlegal,
		_ab_cdc_deleted_at,
		_ab_cdc_updated_at,
		codigopostalimprime,
		telefononotificante,
		claestatusconsignado,
		esgeneracargoimpuesto,
		_ab_cdc_event_serial_no,
		claveinternacionalnotificante
 )
select * from de_duplicacion_vtacatconsignado
