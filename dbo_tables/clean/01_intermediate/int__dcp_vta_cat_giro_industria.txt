with de_duplicacion_vtacatgiroindustria as (
	select
		*,
		row_number() over(
			partition by clagiroindustria,clagirocomercial
			order by
				fechaultimamod desc
		) as rownum
	from
		{{ ref('stg__vta_cat_giro_industria') }}
),
sel_vtacatgiroindustria as (
	select
		_airbyte_raw_id,
		_airbyte_extracted_at,
		_airbyte_meta,
		bajalogica,
		nombrepcmod,
		_ab_cdc_lsn,
		clausuariomod,
		fechaultimamod,
		_ab_cdc_cursor,
		fechabajalogica,
		clagirocomercial,
		clagiroindustria,
		_ab_cdc_deleted_at,
		_ab_cdc_updated_at,
		nombregiroindustria,
		nombregiroindustriaing,
		_ab_cdc_event_serial_no
	from
		de_duplicacion_vtacatgiroindustria
	where
		rownum = 1
)
select
	*
from
	sel_vtacatgiroindustria