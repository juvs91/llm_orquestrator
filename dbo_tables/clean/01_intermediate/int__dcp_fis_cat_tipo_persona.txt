with
	de_duplicacion_fiscattipopersona
	as
	(
		select

			*,

			row_number() over(

        partition by clatipopersona
        order by fechaultimamod desc
        ) as rownum
		from {{ref ('stg__fis_cat_tipo_persona')}}
),sel_fiscattipopersona as
( 
select _airbyte_raw_id,
	_airbyte_extracted_at,
	_airbyte_meta,
	bajalogica,
	nombrepcmod,
	_ab_cdc_lsn,
	clausuariomod,
	clatipopersona,
	fechaultimamod,
	nomtipopersona,
	_ab_cdc_cursor,
	fechabajalogica,
	nomtipopersonaen,
	_ab_cdc_deleted_at,
	_ab_cdc_updated_at,
	_ab_cdc_event_serial_no
	from de_duplicacion_fiscattipopersona
where rownum=1
 )
select *
from
	sel_fiscattipopersona